<html>
<tal:block metal:define-macro="icing">
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<head>
<title metal:define-slot="head_title">title goes here</title>

<link rel="stylesheet" href="@@file/chromatron/HTML5/css/style.css">
<link rel="stylesheet" href="@@file/chromatron/HTML5/css/colors.css">
<link rel="stylesheet" href="@@file/chromatron/HTML5/css/jquery.wysiwyg.css">
<link rel="stylesheet" href="@@file/chromatron/HTML5/css/jquery.datatables.css">
<link rel="stylesheet" href="@@file/chromatron/HTML5/css/jquery.facebox.css">
<link rel="stylesheet" href="@@file/chromatron/HTML5/css/jquery.datepicker.css">
<link rel="stylesheet" href="@@file/chromatron/HTML5/css/jquery.fileinput.css">
<link rel="stylesheet" href="@@file/chromatron/HTML5/css/jquery.fullcalendar.css">
<link rel="stylesheet" href="@@file/chromatron/HTML5/css/jquery.visualize.css">

<link href='http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>

<script src="@@file/chromatron/HTML5/js/libs/modernizr-1.7.min.js"></script>

<meta http-equiv="Content-Type"
 tal:attributes="content string:text/html;; charset=${request/client/charset}" />
<script tal:replace="structure request/base_javascript">
</script>
<metal:x define-slot="more-javascript" />

</head>
<body>

<section role="navigation">
<nav id=main-nav
tal:define="
kw_edit python:request.user.hasPermission('Edit', 'keyword');
kw_create python:request.user.hasPermission('Create', 'keyword');
kw_edit_link python:kw_edit and db.keyword.list();
columns string:id,title,creator,status,department;
columns_showall string:id,title,creator,status,priority,department;
status_notresolved string:1,2,3,4,5,6,-7;
"
>
<section class="sidebar">
<img class="logo" src="http://isaw.nyu.edu/isawdoortoday.png" />
</section>

<!--
  <div id="body-title">
   <header>
     <h2 style="cursor: s-resize;">
     <span metal:define-slot="body_title">body title</span>
     </h2>
   </header>
   </div>
-->

  <!--
  <span class="classblock"
     tal:condition="python:request.user.hasPermission('View', 'query')">
   <span i18n:translate=""
    ><b>Your Queries</b> <a class="button" href="query?@template=edit">edit</a></span>
   <tal:block tal:repeat="qs request/user/queries">
    <a href="#" tal:attributes="href string:${qs/klass}?${qs/url}&@dispname=${qs/name}"
       tal:content="qs/name">link</a><br>
   </tal:block>
  </span>
  -->

  <section class="sidebar nested">
  <form method="POST" tal:attributes="action request/base">
    <b i18n:translate="">Tickets</b>
    <br />
    <span tal:condition="python:request.user.hasPermission('View', 'issue')">
    <span tal:condition="python:request.user.username=='anonymous'">
     <li>
      <a href="issue?@template=login">Login</a>
    </li>
    </span>
   <span tal:condition="python:request.user.hasPermission('Create', 'issue')">
      <a href="issue?@template=item" title="" i18n:translate="">New ticket</a>
    </span>
   <li>
    <a href="#"
       class="gallery no-submenu"
       title=""
       tal:attributes="href python:request.indexargs_url('issue', {
      '@sort': '-activity',
      '@group': '-priority',
      '@filter': 'status',
      '@columns': columns_showall,
      '@search_text': '',
      'status': status_notresolved,
      '@pagesize': 15,
     })"
       i18n:translate="">Home</a>
    </li>
  </span>
  </form>
  </section>

  <!--
  <p class="classblock"
     tal:condition="python:kw_edit or kw_create">
   <b i18n:translate="">Keywords</b><br>
   <span tal:condition="python:request.user.hasPermission('Create', 'keyword')">
    <a href="keyword?@template=item" i18n:translate="">Create New</a><br>
   </span>
   <span tal:condition="kw_edit_link">
    <a href="keyword?@template=item" i18n:translate="">Edit Existing</a><br>
   </span>
  </p>
  -->

  <section tal:condition="python:request.user.hasPermission('Edit', 'None')" class="sidebar nested">
  <p class="classblock"
       tal:condition="python:request.user.hasPermission('Edit', 'None')">
   <b i18n:translate="">Administration</b><br>
   <span tal:condition="python:request.user.hasPermission('Edit', None)">
    <a href="home?@template=classlist" i18n:translate="">Class List</a><br>
   </span>
   <span tal:condition="python:request.user.hasPermission('Edit', 'None')">
   <!--                         or request.user.hasPermission('Edit', 'user')"> -->
    <a href="user"  i18n:translate="">User List</a><br>
   </span>
   <a tal:condition="python:request.user.hasPermission('Create', 'user')"
      href="user?@template=item" i18n:translate="">Add User</a>
  </p>
  </section>

  <div>
  <!-- LOST DATA LOGIN -->
  <!--
  <form method="POST" tal:condition="python:request.user.username=='anonymous'"
        tal:attributes="action request/base">
   <p class="userblock">
    <b i18n:translate="">Login</b><br>
    <input size="10" name="__login_name"><br>
    <input size="10" type="password" name="__login_password"><br>
    <input type="hidden" name="@action" value="Login">
    <input type="checkbox" name="remember" id="remember">
    <label for="remember" i18n:translate="">Remember me?</label><br>
    <button type="submit" value="Login" i18n:attributes="value">Login</button><br>
    <input type="hidden" name="__came_from" tal:attributes="value string:${request/base}${request/env/PATH_INFO}">
    <span tal:replace="structure request/indexargs_form" />
    <a href="user?@template=register"
       tal:condition="python:request.user.hasPermission('Register', 'user')"
     i18n:translate="">Register</a><br>
    <a href="user?@template=forgotten" i18n:translate="">Lost&nbsp;your&nbsp;login?</a><br>
   </p>
  </form>

  -->
  <section  tal:condition="python:request.user.hasPermission('View', 'user')" class="sidebar nested">
  <p class="userblock" tal:condition="python:request.user.username != 'anonymous'">
   <b i18n:translate=""><span i18n:name="user"
    tal:replace="python:request.user.realname.plain(escape=1)">realname</span></b><br>
    <a href="#"
       tal:attributes="href python:request.indexargs_url('issue', {
      '@sort': '-activity',
      '@group': 'priority',
      '@filter': 'status,assignedto',
      '@columns': 'id,title,creator,status,department',
      '@search_text': '',
      'status': status_notresolved,
      'assignedto': request.user.id,
      '@dispname': i18n.gettext('Your Issues'),
     })"
    i18n:translate="">Your Issues</a><br>
   <a href="#" tal:attributes="href string:user${request/user/id}"
    i18n:translate="">Your Details</a><br>
   <a href="#" tal:attributes="href python:request.indexargs_url('',
       {'@action':'logout'})" i18n:translate="">Logout</a>
  </p>
  </section>

<!-- LOST DATA LOGIN -->
  </div>
  <!--
  <p class="userblock">
   <b i18n:translate="">Help</b><br>
   <a href="http://www.roundup-tracker.org"
    i18n:translate="">Roundup docs</a>
  </p>
  -->
<!--
   <section class="sidebar">
   <div id="searchbox">
     <form method="GET" action="issue">
       <input type="hidden" name="@columns"
	      tal:attributes="value columns_showall"
	      value="id,activity,title,creator,assignedto,status"/>
       <input type="hidden" name="@sort" value="activity"/>
       <input type="hidden" name="@group" value="priority"/>
       <input class="medium" id="search-text" name="@search_text" 
              tal:attributes="value request/search_text | default" />
       <p>
       <input class="button" type="submit" id="submit" name="submit" value="Search"
              i18n:attributes="value" /></p>
     </form>
   </div>
   </section>
-->
<!--
  <p tal:condition="options/error_message | nothing" class="error-message"
     tal:repeat="m options/error_message" tal:content="structure m" />
  <p tal:condition="options/ok_message | nothing" class="ok-message">
    <span tal:repeat="m options/ok_message"
       tal:content="structure string:$m <br/ > " />
     <a class="form-small" tal:attributes="href request/current_url"
        i18n:translate="">clear this message</a>
  </p>
-->

</nav>
</section>

<section role="main">

<article class="full-block clearfix">
<div class="article-container">

<span class="content" metal:define-slot="content"/> <!-- Page content goes here -->

<pre tal:condition="request/form/debug | nothing" tal:content="request">
</pre>

</div>
</article>

</section>
</body>
</tal:block>
</html>
